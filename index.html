<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SCL-90ç—‡çŠ¶è‡ªè¯„é‡è¡¨</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
    <!-- Tailwind é…ç½® -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#4F46E5',
                        secondary: '#EC4899',
                        accent: '#8B5CF6',
                        dark: '#1F2937',
                        light: '#F3F4F6'
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Inter', system-ui, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }
        
        .card {
            backdrop-filter: blur(10px);
            background-color: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #4F46E5 0%, #7C3AED 100%);
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px -5px rgba(79, 70, 229, 0.5);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #EC4899 0%, #F472B6 100%);
            transition: all 0.3s ease;
        }
        
        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px -5px rgba(236, 72, 153, 0.5);
        }
        
        .progress-bar {
            background: linear-gradient(90deg, #4F46E5 0%, #7C3AED 100%);
            transition: width 0.5s ease;
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .gradient-text {
            background: linear-gradient(135deg, #4F46E5 0%, #EC4899 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
    </style>
</head>
<body>
    <!-- å¯¼èˆªæ  -->
    <nav class="bg-white/80 backdrop-blur-md shadow-lg sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0 flex items-center">
                        <i class="fa fa-heartbeat text-2xl text-primary mr-2"></i>
                        <span class="font-bold text-xl text-gray-800">SCL-90å¿ƒç†å¥åº·è¯„ä¼°</span>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <a href="#about" class="text-gray-600 hover:text-primary px-3 py-2 rounded-md text-sm font-medium transition-colors">å…³äºé‡è¡¨</a>
                    <a href="#features" class="text-gray-600 hover:text-primary px-3 py-2 rounded-md text-sm font-medium transition-colors">åŠŸèƒ½ç‰¹ç‚¹</a>
                    <a href="#contact" class="text-gray-600 hover:text-primary px-3 py-2 rounded-md text-sm font-medium transition-colors">è”ç³»æˆ‘ä»¬</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- é¦–é¡µéƒ¨åˆ† -->
        <section id="home" class="fade-in">
            <div class="text-center mb-12">
                <h1 class="text-4xl md:text-5xl font-bold mb-6 gradient-text">SCL-90ç—‡çŠ¶è‡ªè¯„é‡è¡¨</h1>
                <p class="text-xl text-gray-600 max-w-3xl mx-auto mb-8">
                    ä¸“ä¸šçš„å¿ƒç†å¥åº·è‡ªè¯„å·¥å…·ï¼Œå¸®åŠ©æ‚¨å…¨é¢äº†è§£è‡ªå·±çš„å¿ƒç†çŠ¶æ€ï¼ŒåŠæ—¶å‘ç°æ½œåœ¨çš„å¿ƒç†å¥åº·é—®é¢˜
                </p>
                <div class="flex flex-col sm:flex-row justify-center gap-4">
                    <button onclick="showSection('test')" class="btn-primary text-white font-semibold py-3 px-8 rounded-full text-lg shadow-lg">
                        <i class="fa fa-play-circle mr-2"></i>
                        å¼€å§‹æµ‹è¯•
                    </button>
                    <button onclick="showSection('history')" class="btn-secondary text-white font-semibold py-3 px-8 rounded-full text-lg shadow-lg">
                        <i class="fa fa-history mr-2"></i>
                        æŸ¥çœ‹å†å²è®°å½•
                    </button>
                </div>
            </div>

            <!-- åŠŸèƒ½ç‰¹ç‚¹ -->
            <div id="features" class="grid md:grid-cols-3 gap-8 mb-16">
                <div class="card rounded-xl shadow-xl p-6 hover:shadow-2xl transition-all duration-300">
                    <div class="w-16 h-16 bg-indigo-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fa fa-bar-chart text-2xl text-primary"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900 text-center mb-3">ç§‘å­¦è¯„ä¼°</h3>
                    <p class="text-gray-600 text-center">
                        åŸºäºå›½é™…æ ‡å‡†SCL-90é‡è¡¨ï¼ŒåŒ…å«90ä¸ªé—®é¢˜ï¼Œä»9ä¸ªç»´åº¦å…¨é¢è¯„ä¼°å¿ƒç†å¥åº·çŠ¶å†µ
                    </p>
                </div>
                <div class="card rounded-xl shadow-xl p-6 hover:shadow-2xl transition-all duration-300">
                    <div class="w-16 h-16 bg-pink-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fa fa-pie-chart text-2xl text-secondary"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900 text-center mb-3">è¯¦ç»†æŠ¥å‘Š</h3>
                    <p class="text-gray-600 text-center">
                        ç”Ÿæˆä¸“ä¸šçš„è¯„ä¼°æŠ¥å‘Šï¼ŒåŒ…å«åˆ†æ•°åˆ†æã€ç—‡çŠ¶è§£è¯»å’Œå¥åº·å»ºè®®ï¼Œå¸®åŠ©æ‚¨æ›´å¥½åœ°äº†è§£è‡ªå·±
                    </p>
                </div>
                <div class="card rounded-xl shadow-xl p-6 hover:shadow-2xl transition-all duration-300">
                    <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fa fa-lock text-2xl text-accent"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900 text-center mb-3">éšç§ä¿æŠ¤</h3>
                    <p class="text-gray-600 text-center">
                        æ‰€æœ‰æ•°æ®ä»…å­˜å‚¨åœ¨æ‚¨çš„è®¾å¤‡ä¸Šï¼Œä¸ä¼šä¸Šä¼ åˆ°ä»»ä½•æœåŠ¡å™¨ï¼Œç¡®ä¿æ‚¨çš„éšç§å®‰å…¨
                    </p>
                </div>
            </div>

            <!-- å…³äºé‡è¡¨ -->
            <div id="about" class="bg-white rounded-xl shadow-xl p-8 mb-16">
                <h2 class="text-2xl font-bold text-gray-900 mb-6 text-center">å…³äºSCL-90é‡è¡¨</h2>
                <div class="grid md:grid-cols-2 gap-8">
                    <div>
                        <p class="text-gray-700 mb-4">
                            SCL-90ï¼ˆSymptom Checklist 90ï¼‰æ˜¯ä¸–ç•Œä¸Šæœ€è‘—åçš„å¿ƒç†å¥åº·æµ‹è¯•é‡è¡¨ä¹‹ä¸€ï¼Œç”±Derogatisç¼–åˆ¶äº1975å¹´ã€‚è¯¥é‡è¡¨åŒ…å«90ä¸ªé¡¹ç›®ï¼Œä»9ä¸ªç»´åº¦è¯„ä¼°å¿ƒç†å¥åº·çŠ¶å†µï¼š
                        </p>
                        <ul class="list-disc pl-6 space-y-2 text-gray-700">
                            <li><strong>èº¯ä½“åŒ–ï¼š</strong>åæ˜ ä¸»è§‚çš„èº¯ä½“ä¸é€‚æ„Ÿ</li>
                            <li><strong>å¼ºè¿«ç—‡çŠ¶ï¼š</strong>åæ˜ å¼ºè¿«è§‚å¿µå’Œè¡Œä¸º</li>
                            <li><strong>äººé™…å…³ç³»æ•æ„Ÿï¼š</strong>åæ˜ äººé™…å…³ç³»ä¸­çš„ä¸è‡ªåœ¨æ„Ÿ</li>
                            <li><strong>æŠ‘éƒï¼š</strong>åæ˜ æŠ‘éƒæƒ…ç»ªå’Œç—‡çŠ¶</li>
                            <li><strong>ç„¦è™‘ï¼š</strong>åæ˜ ç„¦è™‘æƒ…ç»ªå’Œç—‡çŠ¶</li>
                            <li><strong>æ•Œå¯¹ï¼š</strong>åæ˜ æ•Œå¯¹æƒ…ç»ªå’Œè¡Œä¸º</li>
                            <li><strong>ææ€–ï¼š</strong>åæ˜ ææ€–æƒ…ç»ªå’Œç—‡çŠ¶</li>
                            <li><strong>åæ‰§ï¼š</strong>åæ˜ åæ‰§è§‚å¿µå’Œç—‡çŠ¶</li>
                            <li><strong>ç²¾ç¥ç—…æ€§ï¼š</strong>åæ˜ ç²¾ç¥ç—…æ€§ç—‡çŠ¶</li>
                        </ul>
                    </div>
                    <div>
                        <p class="text-gray-700 mb-4">
                            è¯¥é‡è¡¨é‡‡ç”¨5çº§è¯„åˆ†åˆ¶ï¼ˆ1-5åˆ†ï¼‰ï¼Œè¯„åˆ†æ ‡å‡†å¦‚ä¸‹ï¼š
                        </p>
                        <div class="bg-gray-50 p-4 rounded-lg mb-4">
                            <ul class="space-y-2 text-gray-700">
                                <li><strong>1åˆ†ï¼š</strong>æ²¡æœ‰ - è‡ªè§‰æ— è¯¥é¡¹ç—‡çŠ¶</li>
                                <li><strong>2åˆ†ï¼š</strong>å¾ˆè½» - è‡ªè§‰æœ‰è¯¥é¡¹ç—‡çŠ¶ï¼Œä½†å¯¹ç”Ÿæ´»å½±å“è½»å¾®</li>
                                <li><strong>3åˆ†ï¼š</strong>ä¸­ç­‰ - è‡ªè§‰æœ‰è¯¥é¡¹ç—‡çŠ¶ï¼Œå¯¹ç”Ÿæ´»æœ‰ä¸€å®šå½±å“</li>
                                <li><strong>4åˆ†ï¼š</strong>åé‡ - è‡ªè§‰æœ‰è¯¥é¡¹ç—‡çŠ¶ï¼Œå¯¹ç”Ÿæ´»æœ‰è¾ƒå¤§å½±å“</li>
                                <li><strong>5åˆ†ï¼š</strong>ä¸¥é‡ - è‡ªè§‰æœ‰è¯¥é¡¹ç—‡çŠ¶ï¼Œå¯¹ç”Ÿæ´»æœ‰ä¸¥é‡å½±å“</li>
                            </ul>
                        </div>
                        <p class="text-gray-700">
                            æµ‹è¯•å®Œæˆåï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è®¡ç®—å„ç»´åº¦å¾—åˆ†å’Œæ€»å¾—åˆ†ï¼Œå¹¶ç”Ÿæˆè¯¦ç»†çš„è¯„ä¼°æŠ¥å‘Šã€‚è¯¥æŠ¥å‘Šä»…ä¾›å‚è€ƒï¼Œä¸èƒ½æ›¿ä»£ä¸“ä¸šåŒ»ç”Ÿçš„è¯Šæ–­ã€‚
                        </p>
                    </div>
                </div>
            </div>

            <!-- å°çº¢ä¹¦-å°‘å¥³å°¤è¿¦åº—é“ºé“¾æ¥ -->
            <div class="bg-gradient-to-r from-pink-500 to-rose-500 rounded-xl shadow-xl p-8 mb-16 text-center">
                <h2 class="text-2xl font-bold text-white mb-4">ğŸ“• å°çº¢ä¹¦-å°‘å¥³å°¤è¿¦</h2>
                <p class="text-white/90 mb-6 text-lg">
                    æ¬¢è¿å…³æ³¨æˆ‘ä»¬çš„å°çº¢ä¹¦åº—é“ºï¼Œè·å–æ›´å¤šå¿ƒç†å¥åº·çŸ¥è¯†å’Œä¸“ä¸šæµ‹è¯„æœåŠ¡
                </p>
                <a href="https://xhslink.com/m/2VA9dRHonS8" target="_blank" class="bg-white text-pink-600 font-semibold py-3 px-8 rounded-full text-lg shadow-lg hover:shadow-2xl transition-all duration-300 inline-flex items-center">
                    <i class="fa fa-shopping-bag mr-2"></i>
                    è®¿é—®å°çº¢ä¹¦-å°‘å¥³å°¤è¿¦
                </a>
            </div>

            <!-- æ¸©é¦¨æç¤º -->
            <div class="bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl shadow-xl p-8 text-center text-white">
                <h2 class="text-2xl font-bold mb-4">ğŸ’ æ¸©é¦¨æç¤º</h2>
                <div class="max-w-3xl mx-auto">
                    <div class="bg-white/10 backdrop-blur-sm rounded-lg p-6 mb-6">
                        <p class="text-lg mb-4">
                            å¿ƒç†å¥åº·æ˜¯æˆ‘ä»¬ç”Ÿæ´»ä¸­ä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ï¼Œå®šæœŸè¿›è¡Œè‡ªæˆ‘è¯„ä¼°æœ‰åŠ©äºåŠæ—¶å‘ç°é—®é¢˜å¹¶å¯»æ±‚å¸®åŠ©ã€‚
                        </p>
                        <ul class="space-y-3 text-left">
                            <li class="flex items-start">
                                <i class="fa fa-heart mr-3 mt-1 text-pink-300"></i>
                                <span>è¯·åœ¨å®‰é™èˆ’é€‚çš„ç¯å¢ƒä¸­å®Œæˆæµ‹è¯•ï¼Œä¿æŒçœŸå®çš„è‡ªæˆ‘æ„Ÿå—</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fa fa-star mr-3 mt-1 text-yellow-300"></i>
                                <span>æµ‹è¯•ç»“æœä»…ä¾›å‚è€ƒï¼Œå¦‚æœ‰éœ€è¦è¯·å’¨è¯¢ä¸“ä¸šå¿ƒç†åŒ»ç”Ÿ</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fa fa-shield mr-3 mt-1 text-green-300"></i>
                                <span>æ‰€æœ‰æµ‹è¯•æ•°æ®ä»…å­˜å‚¨åœ¨æ‚¨çš„è®¾å¤‡ä¸Šï¼Œæˆ‘ä»¬é‡è§†æ‚¨çš„éšç§ä¿æŠ¤</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fa fa-users mr-3 mt-1 text-blue-300"></i>
                                <span>å…³æ³¨æˆ‘ä»¬çš„å°çº¢ä¹¦-å°‘å¥³å°¤è¿¦ï¼Œè·å–æ›´å¤šå¿ƒç†å¥åº·çŸ¥è¯†å’Œä¸“ä¸šæ”¯æŒ</span>
                            </li>
                        </ul>
                    </div>
                    <p class="text-white/90 italic">
                        "æ¯ä¸€æ¬¡è‡ªæˆ‘è§‰å¯Ÿï¼Œéƒ½æ˜¯æˆé•¿çš„å¼€å§‹ã€‚æ„¿æ‚¨æ‹¥æœ‰å¥åº·çš„å¿ƒç†çŠ¶æ€ï¼Œäº«å—ç¾å¥½çš„ç”Ÿæ´»ã€‚"
                    </p>
                </div>
            </div>
        </section>

        <!-- æµ‹è¯•éƒ¨åˆ† -->
        <section id="test" class="hidden fade-in">
            <div class="bg-white rounded-xl shadow-xl p-8">
                <div class="flex justify-between items-center mb-8">
                    <h2 class="text-2xl font-bold text-gray-900">SCL-90ç—‡çŠ¶è‡ªè¯„é‡è¡¨</h2>
                    <button onclick="showSection('home')" class="text-gray-500 hover:text-gray-700 transition-colors">
                        <i class="fa fa-arrow-left mr-1"></i> è¿”å›
                    </button>
                </div>

                <!-- è¿›åº¦æ¡ -->
                <div class="mb-8">
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-sm font-medium text-gray-700">è¿›åº¦</span>
                        <span id="progress-text" class="text-sm font-medium text-gray-700">0/90</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2.5">
                        <div id="progress-bar" class="progress-bar h-2.5 rounded-full" style="width: 0%"></div>
                    </div>
                </div>

                <!-- æµ‹è¯•è¯´æ˜ -->
                <div id="test-instructions" class="mb-8 bg-blue-50 p-6 rounded-lg">
                    <h3 class="text-lg font-semibold text-gray-900 mb-3">æµ‹è¯•è¯´æ˜</h3>
                    <p class="text-gray-700 mb-4">
                        ä»¥ä¸‹åˆ—å‡ºäº†æœ‰äº›äººå¯èƒ½ä¼šæœ‰çš„é—®é¢˜ï¼Œè¯·ä»”ç»†é˜…è¯»æ¯ä¸€æ¡ï¼Œç„¶åæ ¹æ®æœ€è¿‘ä¸€å‘¨å†…ï¼ˆåŒ…æ‹¬ä»Šå¤©ï¼‰çš„å®é™…æ„Ÿå—ï¼Œé€‰æ‹©æœ€ç¬¦åˆæ‚¨æƒ…å†µçš„ç­”æ¡ˆã€‚
                    </p>
                    <div class="grid md:grid-cols-5 gap-4 text-center text-sm">
                        <div class="bg-white p-2 rounded border border-gray-200">
                            <div class="font-semibold text-blue-600">1</div>
                            <div class="text-gray-600">æ²¡æœ‰</div>
                        </div>
                        <div class="bg-white p-2 rounded border border-gray-200">
                            <div class="font-semibold text-blue-600">2</div>
                            <div class="text-gray-600">å¾ˆè½»</div>
                        </div>
                        <div class="bg-white p-2 rounded border border-gray-200">
                            <div class="font-semibold text-blue-600">3</div>
                            <div class="text-gray-600">ä¸­ç­‰</div>
                        </div>
                        <div class="bg-white p-2 rounded border border-gray-200">
                            <div class="font-semibold text-blue-600">4</div>
                            <div class="text-gray-600">åé‡</div>
                        </div>
                        <div class="bg-white p-2 rounded border border-gray-200">
                            <div class="font-semibold text-blue-600">5</div>
                            <div class="text-gray-600">ä¸¥é‡</div>
                        </div>
                    </div>
                </div>

                <!-- æµ‹è¯•é¢˜ç›® -->
                <div id="test-questions" class="mb-8">
                    <!-- é¢˜ç›®å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>

                <!-- æ“ä½œæŒ‰é’® -->
                <div class="flex justify-between">
                    <button id="prev-btn" class="bg-gray-200 text-gray-700 font-medium py-2 px-6 rounded-lg hover:bg-gray-300 transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
                        <i class="fa fa-arrow-left mr-2"></i> ä¸Šä¸€é¢˜
                    </button>
                    <button id="next-btn" class="btn-primary text-white font-medium py-2 px-6 rounded-lg">
                        ä¸‹ä¸€é¢˜ <i class="fa fa-arrow-right ml-2"></i>
                    </button>
                </div>
            </div>
        </section>

        <!-- ç»“æœéƒ¨åˆ† -->
        <section id="result" class="hidden fade-in">
            <div class="bg-white rounded-xl shadow-xl p-8">
                <div class="flex justify-between items-center mb-8">
                    <h2 class="text-2xl font-bold text-gray-900">æµ‹è¯•ç»“æœ</h2>
                    <button onclick="showSection('home')" class="text-gray-500 hover:text-gray-700 transition-colors">
                        <i class="fa fa-arrow-left mr-1"></i> è¿”å›é¦–é¡µ
                    </button>
                </div>

                <!-- æ€»ä½“è¯„ä¼° -->
                <div id="overall-assessment" class="mb-8">
                    <!-- æ€»ä½“è¯„ä¼°å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>

                <!-- å› å­åˆ†å›¾è¡¨ -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">å„å› å­å¾—åˆ†</h3>
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <canvas id="factor-chart" width="400" height="200"></canvas>
                    </div>
                </div>

                <!-- å› å­åˆ†è¯¦æƒ… -->
                <div id="factor-details" class="mb-8">
                    <!-- å› å­åˆ†è¯¦æƒ…å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>

                <!-- ç—‡çŠ¶åˆ†å¸ƒçƒ­åŠ›å›¾ -->
                <div class="mb-8">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">ç—‡çŠ¶åˆ†å¸ƒçƒ­åŠ›å›¾</h3>
                    <div id="heatmap" class="grid grid-cols-9 gap-1">
                        <!-- çƒ­åŠ›å›¾å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>

                <!-- å¥åº·å»ºè®® -->
                <div id="health-suggestions" class="mb-8 bg-green-50 p-6 rounded-lg">
                    <h3 class="text-lg font-semibold text-gray-900 mb-3">å¥åº·å»ºè®®</h3>
                    <!-- å¥åº·å»ºè®®å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>

                <!-- æ“ä½œæŒ‰é’® -->
                <div class="flex flex-col sm:flex-row justify-center gap-4">
                    <button onclick="saveTestResult()" class="btn-primary text-white font-medium py-2 px-6 rounded-lg">
                        <i class="fa fa-save mr-2"></i> ä¿å­˜ç»“æœ
                    </button>
                    <button onclick="printTestResult()" class="btn-secondary text-white font-medium py-2 px-6 rounded-lg">
                        <i class="fa fa-print mr-2"></i> æ‰“å°æŠ¥å‘Š
                    </button>
                    <button onclick="shareTestResult()" class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-6 rounded-lg transition-colors">
                        <i class="fa fa-share-alt mr-2"></i> åˆ†äº«ç»“æœ
                    </button>
                </div>
            </div>
        </section>

        <!-- å†å²è®°å½•éƒ¨åˆ† -->
        <section id="history" class="hidden fade-in">
            <div class="bg-white rounded-xl shadow-xl p-8">
                <div class="flex justify-between items-center mb-8">
                    <h2 class="text-2xl font-bold text-gray-900">å†å²è®°å½•</h2>
                    <button onclick="showSection('home')" class="text-gray-500 hover:text-gray-700 transition-colors">
                        <i class="fa fa-arrow-left mr-1"></i> è¿”å›é¦–é¡µ
                    </button>
                </div>

                <!-- å†å²è®°å½•åˆ—è¡¨ -->
                <div id="history-list" class="mb-8">
                    <!-- å†å²è®°å½•å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>

                <!-- æ— è®°å½•æç¤º -->
                <div id="no-history" class="text-center py-12 hidden">
                    <div class="w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fa fa-history text-3xl text-gray-400"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900 mb-2">æš‚æ— å†å²è®°å½•</h3>
                    <p class="text-gray-600 mb-6">æ‚¨è¿˜æ²¡æœ‰å®Œæˆè¿‡ä»»ä½•æµ‹è¯•</p>
                    <button onclick="showSection('test')" class="btn-primary text-white font-medium py-2 px-6 rounded-lg">
                        <i class="fa fa-play-circle mr-2"></i>
                        å¼€å§‹ç¬¬ä¸€æ¬¡æµ‹è¯•
                    </button>
                </div>
            </div>
        </section>
    </div>

    <!-- é¡µè„š -->
    <footer class="bg-gray-800 text-white py-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid md:grid-cols-3 gap-8">
                <div>
                    <h3 class="text-lg font-semibold mb-4">å…³äºé¡¹ç›®</h3>
                    <p class="text-gray-300">SCL-90å¿ƒç†å¥åº·è‡ªè¯„é‡è¡¨åœ¨çº¿è¯„ä¼°ç³»ç»Ÿï¼Œæä¾›ä¸“ä¸šçš„å¿ƒç†å¥åº·æ£€æµ‹æœåŠ¡ã€‚</p>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-4">å¿«é€Ÿé“¾æ¥</h3>
                    <ul class="space-y-2">
                        <li><a href="#" onclick="showSection('home'); return false;" class="text-gray-300 hover:text-white">é¦–é¡µ</a></li>
                        <li><a href="#" onclick="showSection('test'); return false;" class="text-gray-300 hover:text-white">å¼€å§‹æµ‹è¯•</a></li>
                        <li><a href="#" onclick="showSection('history'); return false;" class="text-gray-300 hover:text-white">å†å²è®°å½•</a></li>
                        <li><a href="#about" class="text-gray-300 hover:text-white">å…³äºé‡è¡¨</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-4">å…³æ³¨æˆ‘ä»¬</h3>
                    <p class="text-gray-300 mb-2">è·å–æ›´å¤šå¿ƒç†å¥åº·çŸ¥è¯†å’Œä¸“ä¸šæ”¯æŒ</p>
                    <a href="https://xhslink.com/m/2VA9dRHonS8" target="_blank" class="inline-flex items-center text-gray-300 hover:text-white transition-colors">
                        <i class="fa fa-book text-xl mr-2"></i>
                        å°çº¢ä¹¦-å°‘å¥³å°¤è¿¦
                    </a>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-8 pt-6 text-center text-gray-400">
                <p>&copy; 2026 SCL-90å¿ƒç†å¥åº·è¯„ä¼°ç³»ç»Ÿ. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- é€šçŸ¥ç»„ä»¶ -->
    <div id="notification" class="fixed top-4 right-4 transform translate-x-full transition-transform duration-300 z-50">
        <div class="bg-white rounded-lg shadow-lg border border-gray-200 p-4 max-w-sm">
            <div class="flex items-start">
                <div id="notificationIcon" class="flex-shrink-0">
                    <i class="fa fa-check-circle text-green-500 text-xl"></i>
                </div>
                <div class="ml-3 w-0 flex-1">
                    <p id="notificationTitle" class="text-sm font-medium text-gray-900"></p>
                    <p id="notificationMessage" class="mt-1 text-sm text-gray-500"></p>
                </div>
                <div class="ml-4 flex-shrink-0 flex">
                    <button id="closeNotification" class="bg-white rounded-md inline-flex text-gray-400 hover:text-gray-500 focus:outline-none">
                        <span class="sr-only">å…³é—­</span>
                        <i class="fa fa-times"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // SCL-90é‡è¡¨é¢˜ç›®æ•°æ®
        const scl90Questions = [
            { id: 1, text: "å¤´ç—›", factor: "somatization" },
            { id: 2, text: "ç¥ç»è¿‡æ•ï¼Œå¿ƒä¸­ä¸è¸å®", factor: "anxiety" },
            { id: 3, text: "å¤´è„‘ä¸­æœ‰ä¸å¿…è¦çš„æƒ³æ³•æˆ–å­—å¥ç›˜æ—‹", factor: "obsessive" },
            { id: 4, text: "å¤´æ™•æˆ–æ™•å€’", factor: "somatization" },
            { id: 5, text: "å¯¹å¼‚æ€§çš„å…´è¶£å‡é€€", factor: "depression" },
            { id: 6, text: "å¯¹æ—äººæ±‚å…¨è´£å¤‡", factor: "interpersonal" },
            { id: 7, text: "æ„Ÿåˆ°åˆ«äººèƒ½æ§åˆ¶æ‚¨çš„æ€æƒ³", factor: "paranoid" },
            { id: 8, text: "è´£æ€ªåˆ«äººåˆ¶é€ éº»çƒ¦", factor: "hostility" },
            { id: 9, text: "å¿˜è®°æ€§å¤§", factor: "memory" },
            { id: 10, text: "æ‹…å¿ƒè‡ªå·±çš„è¡£é¥°æ•´é½åŠä»ªæ€çš„ç«¯æ­£", factor: "obsessive" },
            { id: 11, text: "å®¹æ˜“çƒ¦æ¼å’Œæ¿€åŠ¨", factor: "anxiety" },
            { id: 12, text: "èƒ¸ç—›", factor: "somatization" },
            { id: 13, text: "å®³æ€•ç©ºæ—·çš„åœºæ‰€æˆ–è¡—é“", factor: "phobic" },
            { id: 14, text: "æ„Ÿåˆ°è‡ªå·±çš„ç²¾åŠ›ä¸‹é™ï¼Œæ´»åŠ¨å‡æ…¢", factor: "depression" },
            { id: 15, text: "æƒ³ç»“æŸè‡ªå·±çš„ç”Ÿå‘½", factor: "depression" },
            { id: 16, text: "å¬åˆ°æ—äººå¬ä¸åˆ°çš„å£°éŸ³", factor: "psychotic" },
            { id: 17, text: "å‘æŠ–", factor: "anxiety" },
            { id: 18, text: "æ„Ÿåˆ°å¤§å¤šæ•°äººéƒ½ä¸å¯ä¿¡ä»»", factor: "paranoid" },
            { id: 19, text: "èƒƒå£ä¸å¥½", factor: "somatization" },
            { id: 20, text: "å®¹æ˜“å“­æ³£", factor: "depression" },
            { id: 21, text: "åŒå¼‚æ€§ç›¸å¤„æ—¶æ„Ÿåˆ°å®³ç¾ä¸è‡ªåœ¨", factor: "interpersonal" },
            { id: 22, text: "æ„Ÿåˆ°å—éª—ï¼Œä¸­äº†åœˆå¥—æˆ–æœ‰äººæƒ³æŠ“ä½æ‚¨", factor: "paranoid" },
            { id: 23, text: "æ— ç¼˜æ— æ•…åœ°çªç„¶æ„Ÿåˆ°å®³æ€•", factor: "anxiety" },
            { id: 24, text: "è‡ªå·±ä¸èƒ½æ§åˆ¶åœ°å¤§å‘è„¾æ°”", factor: "hostility" },
            { id: 25, text: "æ€•å•ç‹¬å‡ºé—¨", factor: "phobic" },
            { id: 26, text: "ç»å¸¸è´£æ€ªè‡ªå·±", factor: "depression" },
            { id: 27, text: "è…°ç—›", factor: "somatization" },
            { id: 28, text: "æ„Ÿåˆ°éš¾ä»¥å®Œæˆä»»åŠ¡", factor: "depression" },
            { id: 29, text: "æ„Ÿåˆ°å­¤ç‹¬", factor: "depression" },
            { id: 30, text: "æ„Ÿåˆ°è‹¦é—·", factor: "depression" },
            { id: 31, text: "è¿‡åˆ†æ‹…å¿§", factor: "anxiety" },
            { id: 32, text: "å¯¹äº‹ç‰©ä¸æ„Ÿå…´è¶£", factor: "depression" },
            { id: 33, text: "æ„Ÿåˆ°å®³æ€•", factor: "anxiety" },
            { id: 34, text: "æ‚¨çš„æ„Ÿæƒ…å®¹æ˜“å—åˆ°ä¼¤å®³", factor: "interpersonal" },
            { id: 35, text: "æ—äººèƒ½çŸ¥é“æ‚¨çš„ç§ä¸‹æƒ³æ³•", factor: "psychotic" },
            { id: 36, text: "æ„Ÿåˆ°åˆ«äººä¸ç†è§£æ‚¨ã€ä¸åŒæƒ…æ‚¨", factor: "interpersonal" },
            { id: 37, text: "æ„Ÿåˆ°äººä»¬å¯¹æ‚¨ä¸å‹å¥½ï¼Œä¸å–œæ¬¢æ‚¨", factor: "interpersonal" },
            { id: 38, text: "åšäº‹å¿…é¡»åšå¾—å¾ˆæ…¢ä»¥ä¿è¯åšå¾—æ­£ç¡®", factor: "obsessive" },
            { id: 39, text: "å¿ƒè·³å¾—å¾ˆå‰å®³", factor: "anxiety" },
            { id: 40, text: "æ¶å¿ƒæˆ–èƒƒéƒ¨ä¸èˆ’æœ", factor: "somatization" },
            { id: 41, text: "æ„Ÿåˆ°æ¯”ä¸ä¸Šä»–äºº", factor: "interpersonal" },
            { id: 42, text: "è‚Œè‚‰é…¸ç—›", factor: "somatization" },
            { id: 43, text: "æ„Ÿåˆ°æœ‰äººåœ¨ç›‘è§†æ‚¨ã€è°ˆè®ºæ‚¨", factor: "paranoid" },
            { id: 44, text: "éš¾ä»¥å…¥ç¡", factor: "sleep" },
            { id: 45, text: "åšäº‹å¿…é¡»åå¤æ£€æŸ¥", factor: "obsessive" },
            { id: 46, text: "éš¾ä»¥åšå‡ºå†³å®š", factor: "obsessive" },
            { id: 47, text: "æ€•ä¹˜ç”µè½¦ã€å…¬å…±æ±½è½¦ã€åœ°é“æˆ–ç«è½¦", factor: "phobic" },
            { id: 48, text: "å‘¼å¸æœ‰å›°éš¾", factor: "anxiety" },
            { id: 49, text: "ä¸€é˜µé˜µå‘å†·æˆ–å‘çƒ­", factor: "anxiety" },
            { id: 50, text: "å› ä¸ºæ„Ÿåˆ°å®³æ€•è€Œé¿å¼€æŸäº›ä¸œè¥¿ã€åœºåˆæˆ–æ´»åŠ¨", factor: "phobic" },
            { id: 51, text: "è„‘å­å˜ç©ºäº†", factor: "depression" },
            { id: 52, text: "èº«ä½“å‘éº»æˆ–åˆºç—›", factor: "somatization" },
            { id: 53, text: "å–‰å’™æœ‰æ¢—å¡æ„Ÿ", factor: "somatization" },
            { id: 54, text: "æ„Ÿåˆ°æ²¡æœ‰å‰é€”æ²¡æœ‰å¸Œæœ›", factor: "depression" },
            { id: 55, text: "ä¸èƒ½é›†ä¸­æ³¨æ„åŠ›", factor: "memory" },
            { id: 56, text: "æ„Ÿåˆ°èº«ä½“çš„æŸä¸€éƒ¨åˆ†è½¯å¼±æ— åŠ›", factor: "somatization" },
            { id: 57, text: "æ„Ÿåˆ°ç´§å¼ æˆ–å®¹æ˜“ç´§å¼ ", factor: "anxiety" },
            { id: 58, text: "æ„Ÿåˆ°æ‰‹æˆ–è„šå‘é‡", factor: "somatization" },
            { id: 59, text: "æƒ³åˆ°æ­»äº¡çš„äº‹", factor: "depression" },
            { id: 60, text: "åƒå¾—å¤ªå¤š", factor: "appetite" },
            { id: 61, text: "å½“åˆ«äººçœ‹ç€æ‚¨æˆ–è°ˆè®ºæ‚¨æ—¶æ„Ÿåˆ°ä¸è‡ªåœ¨", factor: "interpersonal" },
            { id: 62, text: "æœ‰ä¸€äº›ä¸å±äºæ‚¨è‡ªå·±çš„æƒ³æ³•", factor: "psychotic" },
            { id: 63, text: "æœ‰æƒ³æ‰“äººæˆ–ä¼¤å®³ä»–äººçš„å†²åŠ¨", factor: "hostility" },
            { id: 64, text: "é†’å¾—å¤ªæ—©", factor: "sleep" },
            { id: 65, text: "å¿…é¡»åå¤æ´—æ‰‹ã€ç‚¹æ•°ç›®æˆ–è§¦æ‘¸æŸäº›ä¸œè¥¿", factor: "obsessive" },
            { id: 66, text: "ç¡å¾—ä¸ç¨³ä¸æ·±", factor: "sleep" },
            { id: 67, text: "æœ‰æƒ³æ‘”åæˆ–ç ´åä¸œè¥¿çš„å†²åŠ¨", factor: "hostility" },
            { id: 68, text: "æœ‰ä¸€äº›åˆ«äººæ²¡æœ‰çš„æƒ³æ³•æˆ–å¿µå¤´", factor: "psychotic" },
            { id: 69, text: "æ„Ÿåˆ°å¯¹åˆ«äººç¥ç»è¿‡æ•", factor: "interpersonal" },
            { id: 70, text: "åœ¨å•†åº—æˆ–ç”µå½±é™¢ç­‰äººå¤šçš„åœ°æ–¹æ„Ÿåˆ°ä¸è‡ªåœ¨", factor: "phobic" },
            { id: 71, text: "æ„Ÿåˆ°ä»»ä½•äº‹æƒ…éƒ½å¾ˆå›°éš¾", factor: "depression" },
            { id: 72, text: "ä¸€é˜µé˜µææƒ§æˆ–æƒŠæ", factor: "anxiety" },
            { id: 73, text: "æ„Ÿåˆ°åœ¨å…¬å…±åœºåˆåƒä¸œè¥¿å¾ˆä¸èˆ’æœ", factor: "phobic" },
            { id: 74, text: "ç»å¸¸ä¸äººäº‰è®º", factor: "hostility" },
            { id: 75, text: "å•ç‹¬ä¸€äººæ—¶ç¥ç»å¾ˆç´§å¼ ", factor: "anxiety" },
            { id: 76, text: "åˆ«äººå¯¹æ‚¨çš„æˆç»©æ²¡æœ‰åšå‡ºæ°å½“çš„è¯„ä»·", factor: "interpersonal" },
            { id: 77, text: "å³ä½¿å’Œåˆ«äººåœ¨ä¸€èµ·ä¹Ÿæ„Ÿåˆ°å­¤å•", factor: "depression" },
            { id: 78, text: "æ„Ÿåˆ°åç«‹ä¸å®‰å¿ƒç¥ä¸å®š", factor: "anxiety" },
            { id: 79, text: "æ„Ÿåˆ°è‡ªå·±æ²¡æœ‰ä»€ä¹ˆä»·å€¼", factor: "depression" },
            { id: 80, text: "æ„Ÿåˆ°ç†Ÿæ‚‰çš„ä¸œè¥¿å˜æˆé™Œç”Ÿæˆ–ä¸åƒæ˜¯çœŸçš„", factor: "psychotic" },
            { id: 81, text: "å¤§å«æˆ–æ‘”ä¸œè¥¿", factor: "hostility" },
            { id: 82, text: "å®³æ€•ä¼šåœ¨å…¬å…±åœºåˆæ™•å€’", factor: "phobic" },
            { id: 83, text: "æ„Ÿåˆ°åˆ«äººæƒ³å æ‚¨çš„ä¾¿å®œ", factor: "paranoid" },
            { id: 84, text: "ä¸ºä¸€äº›æœ‰å…³æ€§çš„æƒ³æ³•è€Œå¾ˆè‹¦æ¼", factor: "obsessive" },
            { id: 85, text: "æ‚¨è®¤ä¸ºåº”è¯¥å› ä¸ºè‡ªå·±çš„è¿‡é”™è€Œå—åˆ°æƒ©ç½š", factor: "depression" },
            { id: 86, text: "æ„Ÿåˆ°è¦èµ¶å¿«æŠŠäº‹æƒ…åšå®Œ", factor: "anxiety" },
            { id: 87, text: "æ„Ÿåˆ°è‡ªå·±çš„èº«ä½“æœ‰ä¸¥é‡é—®é¢˜", factor: "somatization" },
            { id: 88, text: "ä»æœªæ„Ÿåˆ°å’Œå…¶ä»–äººå¾ˆäº²è¿‘", factor: "interpersonal" },
            { id: 89, text: "æ„Ÿåˆ°è‡ªå·±æœ‰ç½ª", factor: "depression" },
            { id: 90, text: "æ„Ÿåˆ°è‡ªå·±çš„è„‘å­æœ‰æ¯›ç—…", factor: "psychotic" }
        ];

        // å› å­å®šä¹‰
        const factorDefinitions = {
            somatization: { name: "èº¯ä½“åŒ–", color: "#4F46E5", questions: [1, 4, 12, 19, 27, 40, 42, 48, 52, 53, 56, 58, 87] },
            obsessive: { name: "å¼ºè¿«ç—‡çŠ¶", color: "#EC4899", questions: [3, 10, 38, 45, 46, 51, 65, 84] },
            interpersonal: { name: "äººé™…å…³ç³»æ•æ„Ÿ", color: "#8B5CF6", questions: [6, 21, 34, 36, 37, 41, 61, 69, 76, 88] },
            depression: { name: "æŠ‘éƒ", color: "#10B981", questions: [5, 14, 15, 20, 22, 26, 29, 30, 32, 54, 71, 79, 85, 89] },
            anxiety: { name: "ç„¦è™‘", color: "#F59E0B", questions: [2, 11, 17, 23, 31, 33, 39, 48, 57, 72, 78, 86] },
            hostility: { name: "æ•Œå¯¹", color: "#EF4444", questions: [8, 24, 63, 67, 74, 81] },
            phobic: { name: "ææ€–", color: "#06B6D4", questions: [13, 25, 47, 50, 70, 73, 82] },
            paranoid: { name: "åæ‰§", color: "#84CC16", questions: [7, 18, 22, 24, 43, 68, 83] },
            psychotic: { name: "ç²¾ç¥ç—…æ€§", color: "#6366F1", questions: [16, 35, 62, 77, 80, 90] },
            memory: { name: "è®¤çŸ¥åŠŸèƒ½", color: "#9333EA", questions: [9, 55] },
            sleep: { name: "ç¡çœ ", color: "#14B8A6", questions: [44, 64, 66] },
            appetite: { name: "é¥®é£Ÿ", color: "#F97316", questions: [60] }
        };

        // å…¨å±€å˜é‡
        let currentQuestionIndex = 0;
        let userAnswers = new Array(scl90Questions.length).fill(0);
        let testResult = null;
        let factorChart = null;

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initializeEventListeners();
            renderTestQuestions();
            loadTestHistory();
        });

        // åˆå§‹åŒ–äº‹ä»¶ç›‘å¬å™¨
        function initializeEventListeners() {
            // å…³é—­é€šçŸ¥
            document.getElementById('closeNotification').addEventListener('click', function() {
                document.getElementById('notification').classList.add('translate-x-full');
            });

            // æµ‹è¯•å¯¼èˆªæŒ‰é’®
            document.getElementById('prev-btn').addEventListener('click', showPreviousQuestion);
            document.getElementById('next-btn').addEventListener('click', showNextQuestion);
        }

        // æ˜¾ç¤ºæŒ‡å®šéƒ¨åˆ†
        function showSection(sectionId) {
            // éšè—æ‰€æœ‰éƒ¨åˆ†
            document.querySelectorAll('section').forEach(section => {
                section.classList.add('hidden');
            });

            // æ˜¾ç¤ºæŒ‡å®šéƒ¨åˆ†
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.classList.remove('hidden');
                
                // å¦‚æœæ˜¯æµ‹è¯•éƒ¨åˆ†ï¼Œåˆå§‹åŒ–æµ‹è¯•
                if (sectionId === 'test') {
                    initializeTest();
                }
                
                // å¦‚æœæ˜¯å†å²è®°å½•éƒ¨åˆ†ï¼ŒåŠ è½½å†å²è®°å½•
                if (sectionId === 'history') {
                    loadTestHistory();
                }
            }

            // æ»šåŠ¨åˆ°é¡¶éƒ¨
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // åˆå§‹åŒ–æµ‹è¯•
        function initializeTest() {
            currentQuestionIndex = 0;
            userAnswers = new Array(scl90Questions.length).fill(0);
            renderTestQuestions();
            updateNavigationButtons();
            updateProgressBar();
        }

        // æ¸²æŸ“æµ‹è¯•é¢˜ç›®
        function renderTestQuestions() {
            const questionsContainer = document.getElementById('test-questions');
            if (!questionsContainer) return;

            const question = scl90Questions[currentQuestionIndex];
            const currentAnswer = userAnswers[currentQuestionIndex];

            questionsContainer.innerHTML = `
                <div class="bg-white p-6 rounded-lg shadow-sm">
                    <div class="flex items-center mb-4">
                        <div class="w-8 h-8 bg-primary text-white rounded-full flex items-center justify-center font-bold mr-3">
                            ${currentQuestionIndex + 1}
                        </div>
                        <h3 class="text-lg font-medium text-gray-900">${question.text}</h3>
                    </div>
                    <div class="grid grid-cols-5 gap-4 mt-6">
                        ${[1, 2, 3, 4, 5].map(score => `
                            <label class="flex flex-col items-center cursor-pointer">
                                <input type="radio" name="question${question.id}" value="${score}" 
                                       class="sr-only peer" ${currentAnswer === score ? 'checked' : ''}
                                       onchange="handleAnswerChange(${score})">
                                <div class="w-12 h-12 rounded-full border-2 border-gray-300 flex items-center justify-center 
                                            peer-checked:border-primary peer-checked:bg-primary peer-checked:text-white 
                                            transition-all duration-200">
                                    ${score}
                                </div>
                                <span class="mt-2 text-xs text-gray-600">${getScoreText(score)}</span>
                            </label>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // è·å–è¯„åˆ†æ–‡æœ¬
        function getScoreText(score) {
            const scoreTexts = ['', 'æ²¡æœ‰', 'å¾ˆè½»', 'ä¸­ç­‰', 'åé‡', 'ä¸¥é‡'];
            return scoreTexts[score] || '';
        }

        // å¤„ç†ç­”æ¡ˆå˜åŒ–
        function handleAnswerChange(score) {
            userAnswers[currentQuestionIndex] = score;
        }

        // æ˜¾ç¤ºä¸Šä¸€é¢˜
        function showPreviousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                renderTestQuestions();
                updateNavigationButtons();
                updateProgressBar();
            }
        }

        // æ˜¾ç¤ºä¸‹ä¸€é¢˜
        function showNextQuestion() {
            // å¦‚æœå½“å‰é¢˜æ²¡æœ‰å›ç­”ï¼Œæç¤ºç”¨æˆ·
            if (userAnswers[currentQuestionIndex] === 0) {
                showNotification('æç¤º', 'è¯·é€‰æ‹©ä¸€ä¸ªç­”æ¡ˆ', 'warning');
                return;
            }

            if (currentQuestionIndex < scl90Questions.length - 1) {
                currentQuestionIndex++;
                renderTestQuestions();
                updateNavigationButtons();
                updateProgressBar();
            } else {
                // æµ‹è¯•å®Œæˆï¼Œè®¡ç®—ç»“æœ
                console.log('æµ‹è¯•å®Œæˆï¼Œå¼€å§‹è®¡ç®—ç»“æœ...');
                console.log('å½“å‰é—®é¢˜ç´¢å¼•:', currentQuestionIndex);
                console.log('é—®é¢˜æ€»æ•°:', scl90Questions.length);
                console.log('ç”¨æˆ·ç­”æ¡ˆæ•°ç»„é•¿åº¦:', userAnswers.length);
                
                // æ£€æŸ¥æ˜¯å¦æ‰€æœ‰é—®é¢˜éƒ½å·²å›ç­”
                const unansweredCount = userAnswers.filter(score => score === 0).length;
                console.log('æœªå›ç­”çš„é—®é¢˜æ•°é‡:', unansweredCount);
                
                if (unansweredCount > 0) {
                    showNotification('æç¤º', `è¿˜æœ‰ ${unansweredCount} ä¸ªé—®é¢˜æœªå›ç­”ï¼Œè¯·å®Œæˆæ‰€æœ‰é—®é¢˜åå†æäº¤ã€‚`, 'warning');
                    return;
                }
                
                calculateTestResult();
            }
        }

        // æ›´æ–°å¯¼èˆªæŒ‰é’®çŠ¶æ€
        function updateNavigationButtons() {
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');

            if (prevBtn) {
                prevBtn.disabled = currentQuestionIndex === 0;
            }

            if (nextBtn) {
                if (currentQuestionIndex === scl90Questions.length - 1) {
                    nextBtn.innerHTML = 'å®Œæˆæµ‹è¯• <i class="fa fa-check ml-2"></i>';
                } else {
                    nextBtn.innerHTML = 'ä¸‹ä¸€é¢˜ <i class="fa fa-arrow-right ml-2"></i>';
                }
            }
        }

        // æ›´æ–°è¿›åº¦æ¡
        function updateProgressBar() {
            const progressBar = document.getElementById('progress-bar');
            const progressText = document.getElementById('progress-text');

            if (progressBar && progressText) {
                const progress = ((currentQuestionIndex + 1) / scl90Questions.length) * 100;
                progressBar.style.width = `${progress}%`;
                progressText.textContent = `${currentQuestionIndex + 1}/${scl90Questions.length}`;
            }
        }

        // è®¡ç®—æµ‹è¯•ç»“æœ
        function calculateTestResult() {
            try {
                console.log('å¼€å§‹è®¡ç®—æµ‹è¯•ç»“æœ...');
                
                // è®¡ç®—å„å› å­å¾—åˆ†
                const factorScores = {};
                const factorMeans = {};
                
                Object.keys(factorDefinitions).forEach(factorKey => {
                    const factor = factorDefinitions[factorKey];
                    const questions = factor.questions;
                    const scores = questions.map(qId => {
                        const questionIndex = scl90Questions.findIndex(q => q.id === qId);
                        return userAnswers[questionIndex] || 0;
                    });
                    
                    const totalScore = scores.reduce((sum, score) => sum + score, 0);
                    const meanScore = questions.length > 0 ? totalScore / questions.length : 0;
                    
                    factorScores[factorKey] = totalScore;
                    factorMeans[factorKey] = meanScore;
                });

                // è®¡ç®—æ€»åˆ†å’Œæ€»å‡åˆ†
                const totalScore = userAnswers.reduce((sum, score) => sum + score, 0);
                const meanScore = userAnswers.length > 0 ? totalScore / userAnswers.length : 0;

                // è®¡ç®—é˜³æ€§é¡¹ç›®æ•°å’Œé˜³æ€§ç—‡çŠ¶å‡åˆ†
                const positiveItems = userAnswers.filter(score => score >= 2).length;
                const positiveMean = positiveItems > 0 ? 
                    userAnswers.filter(score => score >= 2).reduce((sum, score) => sum + score, 0) / positiveItems : 0;

                console.log('è®¡ç®—å®Œæˆï¼Œæ€»åˆ†:', totalScore, 'é˜³æ€§é¡¹ç›®æ•°:', positiveItems);

                // ç”Ÿæˆæµ‹è¯•ç»“æœ
                testResult = {
                    testId: 'test_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),
                    date: new Date().toISOString(),
                    answers: [...userAnswers],
                    scores: {
                        total: totalScore,
                        mean: meanScore,
                        positiveItems: positiveItems,
                        positiveMean: positiveMean,
                        factors: factorScores,
                        factorMeans: factorMeans
                    },
                    interpretation: generateInterpretation(totalScore, meanScore, factorMeans, positiveItems, positiveMean)
                };

                console.log('æµ‹è¯•ç»“æœç”ŸæˆæˆåŠŸ:', testResult.testId);

                // æ˜¾ç¤ºç»“æœé¡µé¢
                displayTestResult();
            } catch (error) {
                console.error('è®¡ç®—æµ‹è¯•ç»“æœæ—¶å‡ºé”™:', error);
                showNotification('é”™è¯¯', 'è®¡ç®—æµ‹è¯•ç»“æœæ—¶å‘ç”Ÿé”™è¯¯ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•ã€‚', 'error');
            }
        }

        // ç”Ÿæˆç»“æœè§£é‡Š
        function generateInterpretation(totalScore, meanScore, factorMeans, positiveItems, positiveMean) {
            // æ€»ä½“è¯„ä¼°
            let overallLevel = '';
            let overallSuggestion = '';
            
            if (totalScore <= 90) {
                overallLevel = 'å¿ƒç†å¥åº·';
                overallSuggestion = 'æ‚¨çš„å¿ƒç†çŠ¶æ€è‰¯å¥½ï¼Œæ²¡æœ‰æ˜æ˜¾çš„å¿ƒç†å¥åº·é—®é¢˜ã€‚å»ºè®®ç»§ç»­ä¿æŒè‰¯å¥½çš„ç”Ÿæ´»ä¹ æƒ¯å’Œå¿ƒæ€ã€‚';
            } else if (totalScore <= 150) {
                overallLevel = 'è½»åº¦å¿ƒç†é—®é¢˜';
                overallSuggestion = 'æ‚¨å¯èƒ½å­˜åœ¨è½»åº¦çš„å¿ƒç†é—®é¢˜ï¼Œå»ºè®®å…³æ³¨è‡ªå·±çš„æƒ…ç»ªå˜åŒ–ï¼Œé€‚å½“æ”¾æ¾ï¼Œå¿…è¦æ—¶å¯»æ±‚ä¸“ä¸šå¸®åŠ©ã€‚';
            } else if (totalScore <= 210) {
                overallLevel = 'ä¸­åº¦å¿ƒç†é—®é¢˜';
                overallSuggestion = 'æ‚¨å¯èƒ½å­˜åœ¨ä¸­åº¦çš„å¿ƒç†é—®é¢˜ï¼Œå»ºè®®åŠæ—¶è°ƒæ•´ç”Ÿæ´»æ–¹å¼ï¼Œå¯»æ±‚å¿ƒç†å’¨è¯¢å¸ˆçš„å¸®åŠ©ã€‚';
            } else {
                overallLevel = 'é‡åº¦å¿ƒç†é—®é¢˜';
                overallSuggestion = 'æ‚¨å¯èƒ½å­˜åœ¨è¾ƒä¸¥é‡çš„å¿ƒç†é—®é¢˜ï¼Œå¼ºçƒˆå»ºè®®å°½å¿«å¯»æ±‚ä¸“ä¸šå¿ƒç†åŒ»ç”Ÿæˆ–ç²¾ç¥ç§‘åŒ»ç”Ÿçš„å¸®åŠ©ã€‚';
            }

            // å› å­åˆ†è¯„ä¼°
            const factorInterpretations = {};
            Object.keys(factorMeans).forEach(factorKey => {
                const mean = factorMeans[factorKey];
                const factor = factorDefinitions[factorKey];
                
                let level = '';
                let suggestion = '';
                
                if (mean <= 1.5) {
                    level = 'æ­£å¸¸';
                    suggestion = `æ‚¨åœ¨${factor.name}æ–¹é¢è¡¨ç°æ­£å¸¸ï¼Œæ— éœ€ç‰¹åˆ«å…³æ³¨ã€‚`;
                } else if (mean <= 2.5) {
                    level = 'è½»åº¦';
                    suggestion = `æ‚¨åœ¨${factor.name}æ–¹é¢å¯èƒ½å­˜åœ¨è½»åº¦é—®é¢˜ï¼Œå»ºè®®é€‚å½“å…³æ³¨ã€‚`;
                } else if (mean <= 3.5) {
                    level = 'ä¸­åº¦';
                    suggestion = `æ‚¨åœ¨${factor.name}æ–¹é¢å¯èƒ½å­˜åœ¨ä¸­åº¦é—®é¢˜ï¼Œå»ºè®®å¯»æ±‚ä¸“ä¸šå»ºè®®ã€‚`;
                } else {
                    level = 'é‡åº¦';
                    suggestion = `æ‚¨åœ¨${factor.name}æ–¹é¢å¯èƒ½å­˜åœ¨è¾ƒä¸¥é‡çš„é—®é¢˜ï¼Œå¼ºçƒˆå»ºè®®å¯»æ±‚ä¸“ä¸šå¸®åŠ©ã€‚`;
                }
                
                factorInterpretations[factorKey] = {
                    level,
                    suggestion,
                    score: mean.toFixed(2)
                };
            });

            return {
                overall: {
                    level: overallLevel,
                    suggestion: overallSuggestion,
                    totalScore: totalScore,
                    meanScore: meanScore.toFixed(2),
                    positiveItems: positiveItems,
                    positiveMean: positiveMean.toFixed(2)
                },
                factors: factorInterpretations
            };
        }

        // æ˜¾ç¤ºæµ‹è¯•ç»“æœ
        function displayTestResult() {
            try {
                if (!testResult) {
                    console.error('æµ‹è¯•ç»“æœä¸ºç©º');
                    showNotification('é”™è¯¯', 'æµ‹è¯•ç»“æœä¸ºç©ºï¼Œè¯·é‡æ–°å®Œæˆæµ‹è¯•ã€‚', 'error');
                    return;
                }

                console.log('å¼€å§‹æ˜¾ç¤ºæµ‹è¯•ç»“æœ...');
                
                // æ˜¾ç¤ºç»“æœéƒ¨åˆ†
                showSection('result');

                // æ¸²æŸ“æ€»ä½“è¯„ä¼°
                renderOverallAssessment();

                // æ¸²æŸ“å› å­åˆ†å›¾è¡¨
                renderFactorChart();

                // æ¸²æŸ“å› å­åˆ†è¯¦æƒ…
                renderFactorDetails();

                // æ¸²æŸ“ç—‡çŠ¶åˆ†å¸ƒçƒ­åŠ›å›¾
                renderSymptomHeatmap();

                // æ¸²æŸ“å¥åº·å»ºè®®
                renderHealthSuggestions();
                
                console.log('æµ‹è¯•ç»“æœæ˜¾ç¤ºå®Œæˆ');
            } catch (error) {
                console.error('æ˜¾ç¤ºæµ‹è¯•ç»“æœæ—¶å‡ºé”™:', error);
                showNotification('é”™è¯¯', 'æ˜¾ç¤ºæµ‹è¯•ç»“æœæ—¶å‘ç”Ÿé”™è¯¯ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•ã€‚', 'error');
            }
        }

        // æ¸²æŸ“æ€»ä½“è¯„ä¼°
        function renderOverallAssessment() {
            const container = document.getElementById('overall-assessment');
            if (!container || !testResult) return;

            const { overall } = testResult.interpretation;
            const levelColors = {
                'å¿ƒç†å¥åº·': 'bg-green-100 text-green-800',
                'è½»åº¦å¿ƒç†é—®é¢˜': 'bg-yellow-100 text-yellow-800',
                'ä¸­åº¦å¿ƒç†é—®é¢˜': 'bg-orange-100 text-orange-800',
                'é‡åº¦å¿ƒç†é—®é¢˜': 'bg-red-100 text-red-800'
            };

            container.innerHTML = `
                <div class="bg-gray-50 p-6 rounded-lg">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-semibold text-gray-900">æ€»ä½“è¯„ä¼°</h3>
                        <span class="px-3 py-1 rounded-full text-sm font-medium ${levelColors[overall.level] || 'bg-blue-100 text-blue-800'}">
                            ${overall.level}
                        </span>
                    </div>
                    <div class="grid md:grid-cols-4 gap-4 mb-4">
                        <div class="bg-gradient-to-r from-blue-500 to-purple-600 p-4 rounded-lg shadow-lg border-2 border-blue-300 transform hover:scale-105 transition-all duration-300">
                            <div class="text-sm text-white/90 mb-1">æ€»åˆ†</div>
                            <div class="text-3xl font-bold text-white flex items-center">
                                ${overall.totalScore}
                                <span class="ml-2 text-sm text-white/80 font-normal">/450</span>
                            </div>
                            <div class="text-xs text-white/70">æ»¡åˆ†ï¼š450</div>
                        </div>
                        <div class="bg-white p-4 rounded-lg shadow-sm">
                            <div class="text-sm text-gray-500 mb-1">æ€»å‡åˆ†</div>
                            <div class="text-2xl font-bold text-gray-900">${overall.meanScore}</div>
                            <div class="text-xs text-gray-400">æ»¡åˆ†ï¼š5</div>
                        </div>
                        <div class="bg-white p-4 rounded-lg shadow-sm">
                            <div class="text-sm text-gray-500 mb-1">é˜³æ€§é¡¹ç›®æ•°</div>
                            <div class="text-2xl font-bold text-gray-900">${overall.positiveItems}</div>
                            <div class="text-xs text-gray-400">æ»¡åˆ†ï¼š90</div>
                        </div>
                        <div class="bg-white p-4 rounded-lg shadow-sm">
                            <div class="text-sm text-gray-500 mb-1">é˜³æ€§ç—‡çŠ¶å‡åˆ†</div>
                            <div class="text-2xl font-bold text-gray-900">${overall.positiveMean}</div>
                            <div class="text-xs text-gray-400">æ»¡åˆ†ï¼š5</div>
                        </div>
                    </div>
                    <div class="bg-white p-4 rounded-lg shadow-sm">
                        <div class="text-sm text-gray-500 mb-2">è¯„ä¼°å»ºè®®</div>
                        <p class="text-gray-700">${overall.suggestion}</p>
                    </div>
                </div>
            `;
        }

        // æ¸²æŸ“å› å­åˆ†å›¾è¡¨
        function renderFactorChart() {
            const canvas = document.getElementById('factor-chart');
            if (!canvas || !testResult) return;

            // é”€æ¯æ—§å›¾è¡¨
            if (factorChart) {
                factorChart.destroy();
            }

            const { factorMeans } = testResult.scores;
            const factors = Object.keys(factorMeans).filter(key => key !== 'memory' && key !== 'sleep' && key !== 'appetite');
            
            const labels = factors.map(key => factorDefinitions[key].name);
            const data = factors.map(key => factorMeans[key]);
            const colors = factors.map(key => factorDefinitions[key].color);

            factorChart = new Chart(canvas, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'å› å­å‡åˆ†',
                        data: data,
                        backgroundColor: colors,
                        borderColor: colors.map(color => color + '80'),
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 5,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const value = context.parsed.y.toFixed(2);
                                    let level = '';
                                    
                                    if (value <= 1.5) level = 'ï¼ˆæ­£å¸¸ï¼‰';
                                    else if (value <= 2.5) level = 'ï¼ˆè½»åº¦ï¼‰';
                                    else if (value <= 3.5) level = 'ï¼ˆä¸­åº¦ï¼‰';
                                    else level = 'ï¼ˆé‡åº¦ï¼‰';
                                    
                                    return `å› å­å‡åˆ†: ${value} ${level}`;
                                }
                            }
                        }
                    }
                }
            });
        }

        // æ¸²æŸ“å› å­åˆ†è¯¦æƒ…
        function renderFactorDetails() {
            const container = document.getElementById('factor-details');
            if (!container || !testResult) return;

            const { factorMeans } = testResult.scores;
            const { factors } = testResult.interpretation;
            
            const levelColors = {
                'æ­£å¸¸': 'bg-green-100 text-green-800',
                'è½»åº¦': 'bg-yellow-100 text-yellow-800',
                'ä¸­åº¦': 'bg-orange-100 text-orange-800',
                'é‡åº¦': 'bg-red-100 text-red-800'
            };

            let html = '<h3 class="text-lg font-semibold text-gray-900 mb-4">å› å­åˆ†è¯¦æƒ…</h3>';
            html += '<div class="grid md:grid-cols-2 gap-4">';

            Object.keys(factorMeans).forEach(factorKey => {
                const factor = factorDefinitions[factorKey];
                const mean = factorMeans[factorKey];
                const interpretation = factors[factorKey];
                
                html += `
                    <div class="bg-white p-4 rounded-lg shadow-sm">
                        <div class="flex items-center justify-between mb-2">
                            <h4 class="font-medium text-gray-900">${factor.name}</h4>
                            <span class="px-2 py-1 rounded-full text-xs font-medium ${levelColors[interpretation.level] || 'bg-blue-100 text-blue-800'}">
                                ${interpretation.level}
                            </span>
                        </div>
                        <div class="flex items-center mb-2">
                            <div class="text-2xl font-bold text-gray-900 mr-2">${mean.toFixed(2)}</div>
                            <div class="text-sm text-gray-500">/ 5</div>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2 mb-2">
                            <div class="h-2 rounded-full" style="width: ${(mean / 5) * 100}%; background-color: ${factor.color}"></div>
                        </div>
                        <p class="text-sm text-gray-600">${interpretation.suggestion}</p>
                    </div>
                `;
            });

            html += '</div>';
            container.innerHTML = html;
        }

        // æ¸²æŸ“ç—‡çŠ¶åˆ†å¸ƒçƒ­åŠ›å›¾
        function renderSymptomHeatmap() {
            const container = document.getElementById('heatmap');
            if (!container || !testResult) return;

            container.innerHTML = '';

            scl90Questions.forEach((question, index) => {
                const score = testResult.answers[index];
                const factor = factorDefinitions[question.factor];
                
                let color = '';
                if (score === 0) color = 'bg-gray-100';
                else if (score === 1) color = 'bg-green-100';
                else if (score === 2) color = 'bg-yellow-100';
                else if (score === 3) color = 'bg-orange-200';
                else if (score === 4) color = 'bg-red-300';
                else color = 'bg-red-500';

                const cell = document.createElement('div');
                cell.className = `${color} aspect-square rounded flex items-center justify-center cursor-pointer hover:ring-2 hover:ring-blue-500 transition-all duration-200`;
                cell.style.border = `1px solid ${factor.color}30`;
                cell.title = `${question.text}\nå¾—åˆ†: ${score} (${getScoreText(score)})`;
                cell.innerHTML = `<span class="text-xs font-medium text-gray-700">${score}</span>`;
                
                container.appendChild(cell);
            });
        }

        // æ¸²æŸ“å¥åº·å»ºè®®
        function renderHealthSuggestions() {
            const container = document.getElementById('health-suggestions');
            if (!container || !testResult) return;

            const { overall, factors } = testResult.interpretation;
            const highRiskFactors = Object.keys(factors).filter(key => factors[key].level === 'é‡åº¦' || factors[key].level === 'ä¸­åº¦');

            let suggestions = [];

            // é€šç”¨å»ºè®®
            suggestions.push('1. ä¿æŒè§„å¾‹çš„ä½œæ¯æ—¶é—´ï¼Œç¡®ä¿å……è¶³çš„ç¡çœ ã€‚');
            suggestions.push('2. é€‚å½“è¿›è¡Œä½“è‚²é”»ç‚¼ï¼Œå¦‚æ•£æ­¥ã€ç‘œä¼½ã€æ¸¸æ³³ç­‰ã€‚');
            suggestions.push('3. åŸ¹å…»å…´è¶£çˆ±å¥½ï¼Œä¸°å¯Œç”Ÿæ´»å†…å®¹ã€‚');
            suggestions.push('4. ä¿æŒè‰¯å¥½çš„äººé™…å…³ç³»ï¼Œå¤šä¸äº²å‹äº¤æµã€‚');
            suggestions.push('5. å­¦ä¹ ç®€å•çš„æ”¾æ¾æŠ€å·§ï¼Œå¦‚æ·±å‘¼å¸ã€å†¥æƒ³ç­‰ã€‚');

            // æ ¹æ®è¯„ä¼°ç»“æœæ·»åŠ ç‰¹å®šå»ºè®®
            if (overall.level !== 'å¿ƒç†å¥åº·') {
                suggestions.push('6. å»ºè®®å¯»æ±‚ä¸“ä¸šå¿ƒç†å’¨è¯¢å¸ˆæˆ–å¿ƒç†åŒ»ç”Ÿçš„å¸®åŠ©ã€‚');
            }

            if (highRiskFactors.includes('depression')) {
                suggestions.push('7. å¤šå‚åŠ ç¤¾äº¤æ´»åŠ¨ï¼Œé¿å…ç‹¬å¤„ï¼Œä¿æŒç§¯æçš„ç¤¾äº¤äº’åŠ¨ã€‚');
            }

            if (highRiskFactors.includes('anxiety')) {
                suggestions.push('8. å­¦ä¹ å‹åŠ›ç®¡ç†æŠ€å·§ï¼Œé¿å…è¿‡åº¦ç´§å¼ å’Œç„¦è™‘ã€‚');
            }

            if (highRiskFactors.includes('sleep')) {
                suggestions.push('9. ç¡å‰é¿å…ä½¿ç”¨ç”µå­è®¾å¤‡ï¼Œåˆ›é€ è‰¯å¥½çš„ç¡çœ ç¯å¢ƒã€‚');
            }

            container.innerHTML = `
                <h3 class="text-lg font-semibold text-gray-900 mb-3">å¥åº·å»ºè®®</h3>
                <ul class="list-disc pl-6 space-y-2 text-gray-700">
                    ${suggestions.map(suggestion => `<li>${suggestion}</li>`).join('')}
                </ul>
                
                <!-- AIæ™ºèƒ½è§£è¯» -->
                <div class="mt-6 bg-gradient-to-r from-indigo-50 to-purple-50 p-5 rounded-xl border border-indigo-100">
                    <div class="flex items-center mb-4">
                        <div class="w-10 h-10 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-full flex items-center justify-center mr-3">
                            <i class="fa fa-robot text-white"></i>
                        </div>
                        <h4 class="text-lg font-semibold text-gray-900">ğŸ¤– AIæ™ºèƒ½è§£è¯»</h4>
                    </div>
                    
                    <div class="space-y-4">
                        <div class="bg-white p-4 rounded-lg shadow-sm border-l-4 border-blue-500">
                            <h5 class="font-medium text-gray-900 mb-2">ğŸ¯ ä¸ªæ€§åŒ–æ”¹å–„å»ºè®®</h5>
                            <ul class="list-disc pl-5 space-y-1 text-sm text-gray-700">
                                <li>æ ¹æ®æ‚¨çš„æµ‹è¯•ç»“æœï¼Œå»ºè®®æ¯å¤©è¿›è¡Œ15-30åˆ†é’Ÿçš„æ­£å¿µå†¥æƒ³ç»ƒä¹ ï¼Œæœ‰åŠ©äºç¼“è§£${highRiskFactors.includes('anxiety') ? 'ç„¦è™‘' : 'å‹åŠ›'}</li>
                                <li>å»ºè®®å»ºç«‹è§„å¾‹çš„ç”Ÿæ´»ä½œæ¯è¡¨ï¼Œç‰¹åˆ«æ˜¯${highRiskFactors.includes('depression') ? 'æƒ…ç»ªä½è½' : 'ç¡çœ è´¨é‡'}æ–¹é¢éœ€è¦é‡ç‚¹å…³æ³¨</li>
                                <li>æ¯å‘¨å®‰æ’3-5æ¬¡æœ‰æ°§è¿åŠ¨ï¼Œæ¯æ¬¡30åˆ†é’Ÿï¼Œå¯æœ‰æ•ˆæ”¹å–„æ•´ä½“å¿ƒç†å¥åº·çŠ¶æ€</li>
                                <li>å°è¯•å­¦ä¹ æƒ…ç»ªæ—¥è®°è®°å½•æ³•ï¼Œæ¯å¤©èŠ±10åˆ†é’Ÿè®°å½•è‡ªå·±çš„æƒ…ç»ªå˜åŒ–å’Œè§¦å‘å› ç´ </li>
                                <li>å»ºè®®å®šæœŸè¿›è¡Œç¤¾äº¤æ´»åŠ¨ï¼Œæ¯å‘¨è‡³å°‘ä¸æœ‹å‹æˆ–å®¶äººè¿›è¡Œ2-3æ¬¡æœ‰è´¨é‡çš„äº¤æµ</li>
                            </ul>
                        </div>
                        
                        <div class="bg-white p-4 rounded-lg shadow-sm border-l-4 border-green-500">
                            <h5 class="font-medium text-gray-900 mb-2">ğŸ“Š æ•°æ®æ´å¯Ÿ</h5>
                            <p class="text-sm text-gray-700">
                                æ‚¨çš„æµ‹è¯•æ•°æ®æ˜¾ç¤ºï¼Œåœ¨${getTopFactor(factors)}æ–¹é¢çš„å¾—åˆ†ç›¸å¯¹è¾ƒé«˜ã€‚
                                è¿™å¯èƒ½ä¸æ‚¨çš„${getPossibleReasons(highRiskFactors)}æœ‰å…³ã€‚
                                å»ºè®®é‡ç‚¹å…³æ³¨è¿™ä¸€é¢†åŸŸçš„æ”¹å–„ã€‚
                            </p>
                        </div>
                        
                        <div class="bg-white p-4 rounded-lg shadow-sm border-l-4 border-purple-500">
                            <h5 class="font-medium text-gray-900 mb-2">ğŸ’¡ ä¸“å®¶å»ºè®®</h5>
                            <p class="text-sm text-gray-700">
                                ${getExpertAdvice(overall.level, highRiskFactors)}
                            </p>
                        </div>
                        
                        <button onclick="generateDetailedAIReport()" class="w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white py-2 px-4 rounded-lg font-medium hover:from-indigo-700 hover:to-purple-700 transition-all duration-300 transform hover:scale-105">
                            <i class="fa fa-file-text-o mr-2"></i>
                            ç”Ÿæˆè¯¦ç»†AIåˆ†ææŠ¥å‘Š
                        </button>
                    </div>
                </div>
            `;
        }

        // ä¿å­˜æµ‹è¯•ç»“æœ
        function saveTestResult() {
            if (!testResult) return;

            try {
                // è·å–ç°æœ‰å†å²è®°å½•
                const history = JSON.parse(localStorage.getItem('testHistory') || '[]');
                
                // æ·»åŠ æ–°ç»“æœ
                history.unshift(testResult);
                
                // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
                localStorage.setItem('testHistory', JSON.stringify(history));
                
                showNotification('æˆåŠŸ', 'æµ‹è¯•ç»“æœå·²ä¿å­˜', 'success');
            } catch (error) {
                console.error('ä¿å­˜æµ‹è¯•ç»“æœæ—¶å‡ºé”™:', error);
                showNotification('é”™è¯¯', 'ä¿å­˜æµ‹è¯•ç»“æœå¤±è´¥', 'error');
            }
        }

        // æ‰“å°æµ‹è¯•æŠ¥å‘Š
        function printTestResult() {
            if (!testResult) return;

            try {
                // åˆ›å»ºæ‰“å°çª—å£
                const printWindow = window.open('', '_blank');
                
                // æ„å»ºæ‰“å°å†…å®¹
                const printContent = generatePrintableReport();
                
                // å†™å…¥æ‰“å°çª—å£
                printWindow.document.write(printContent);
                printWindow.document.close();
                
                // ç­‰å¾…å†…å®¹åŠ è½½å®Œæˆåæ‰“å°
                printWindow.onload = function() {
                    printWindow.print();
                    printWindow.close();
                };
            } catch (error) {
                console.error('æ‰“å°æµ‹è¯•æŠ¥å‘Šæ—¶å‡ºé”™:', error);
                showNotification('é”™è¯¯', 'æ‰“å°æµ‹è¯•æŠ¥å‘Šå¤±è´¥', 'error');
            }
        }

        // ç”Ÿæˆå¯æ‰“å°çš„æŠ¥å‘Š
        function generatePrintableReport() {
            if (!testResult) return '';

            const { overall, factors } = testResult.interpretation;
            const { totalScore, meanScore, positiveItems, positiveMean, factorMeans } = testResult.scores;
            const testDate = new Date(testResult.date).toLocaleString('zh-CN');

            return `
                <!DOCTYPE html>
                <html>
                <head>
                    <title>SCL-90æµ‹è¯•æŠ¥å‘Š</title>
                    <style>
                        body {
                            font-family: Arial, sans-serif;
                            line-height: 1.6;
                            color: #333;
                            max-width: 800px;
                            margin: 0 auto;
                            padding: 20px;
                        }
                        h1, h2, h3 {
                            color: #4F46E5;
                        }
                        .header {
                            text-align: center;
                            margin-bottom: 30px;
                            padding-bottom: 20px;
                            border-bottom: 2px solid #4F46E5;
                        }
                        .summary {
                            background-color: #f8f9fa;
                            padding: 20px;
                            border-radius: 8px;
                            margin-bottom: 30px;
                        }
                        .metrics {
                            display: grid;
                            grid-template-columns: repeat(2, 1fr);
                            gap: 20px;
                            margin-bottom: 20px;
                        }
                        .metric {
                            background-color: white;
                            padding: 15px;
                            border-radius: 8px;
                            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
                        }
                        .metric-label {
                            font-size: 0.9em;
                            color: #666;
                        }
                        .metric-value {
                            font-size: 1.5em;
                            font-weight: bold;
                            color: #333;
                        }
                        .factors {
                            margin-bottom: 30px;
                        }
                        .factor {
                            background-color: white;
                            padding: 15px;
                            border-radius: 8px;
                            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
                            margin-bottom: 15px;
                        }
                        .factor-header {
                            display: flex;
                            justify-content: space-between;
                            align-items: center;
                            margin-bottom: 10px;
                        }
                        .factor-name {
                            font-weight: bold;
                        }
                        .factor-level {
                            padding: 4px 12px;
                            border-radius: 20px;
                            font-size: 0.8em;
                            font-weight: bold;
                        }
                        .level-normal { background-color: #d1fae5; color: #065f46; }
                        .level-mild { background-color: #fef3c7; color: #92400e; }
                        .level-moderate { background-color: #fed7aa; color: #9a3412; }
                        .level-severe { background-color: #fee2e2; color: #991b1b; }
                        .suggestions {
                            background-color: #ecfdf5;
                            padding: 20px;
                            border-radius: 8px;
                            border-left: 4px solid #10b981;
                        }
                        .suggestions ul {
                            padding-left: 20px;
                        }
                        .footer {
                            margin-top: 40px;
                            padding-top: 20px;
                            border-top: 1px solid #e5e7eb;
                            text-align: center;
                            font-size: 0.9em;
                            color: #666;
                        }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>SCL-90ç—‡çŠ¶è‡ªè¯„é‡è¡¨</h1>
                        <h2>æµ‹è¯•æŠ¥å‘Š</h2>
                        <p>æµ‹è¯•æ—¶é—´ï¼š${testDate}</p>
                    </div>

                    <div class="summary">
                        <h3>æ€»ä½“è¯„ä¼°</h3>
                        <div class="metrics">
                            <div class="metric">
                                <div class="metric-label">æ€»åˆ†</div>
                                <div class="metric-value">${totalScore}/450</div>
                            </div>
                            <div class="metric">
                                <div class="metric-label">æ€»å‡åˆ†</div>
                                <div class="metric-value">${meanScore.toFixed(2)}/5</div>
                            </div>
                            <div class="metric">
                                <div class="metric-label">é˜³æ€§é¡¹ç›®æ•°</div>
                                <div class="metric-value">${positiveItems}/90</div>
                            </div>
                            <div class="metric">
                                <div class="metric-label">é˜³æ€§ç—‡çŠ¶å‡åˆ†</div>
                                <div class="metric-value">${positiveMean.toFixed(2)}/5</div>
                            </div>
                        </div>
                        <div class="factor">
                            <div class="factor-header">
                                <span class="factor-name">æ€»ä½“å¿ƒç†å¥åº·æ°´å¹³</span>
                                <span class="factor-level level-${overall.level === 'å¿ƒç†å¥åº·' ? 'normal' : overall.level === 'è½»åº¦å¿ƒç†é—®é¢˜' ? 'mild' : overall.level === 'ä¸­åº¦å¿ƒç†é—®é¢˜' ? 'moderate' : 'severe'}">
                                    ${overall.level}
                                </span>
                            </div>
                            <p>${overall.suggestion}</p>
                        </div>
                    </div>

                    <div class="factors">
                        <h3>å› å­åˆ†è¯¦æƒ…</h3>
                        ${Object.keys(factors).map(factorKey => {
                            const factor = factorDefinitions[factorKey];
                            const interpretation = factors[factorKey];
                            const levelClass = interpretation.level === 'æ­£å¸¸' ? 'normal' : 
                                              interpretation.level === 'è½»åº¦' ? 'mild' : 
                                              interpretation.level === 'ä¸­åº¦' ? 'moderate' : 'severe';
                            
                            return `
                                <div class="factor">
                                    <div class="factor-header">
                                        <span class="factor-name">${factor.name}</span>
                                        <span class="factor-level level-${levelClass}">
                                            ${interpretation.level} (${factorMeans[factorKey].toFixed(2)}/5)
                                        </span>
                                    </div>
                                    <p>${interpretation.suggestion}</p>
                                </div>
                            `;
                        }).join('')}
                    </div>

                    <div class="suggestions">
                        <h3>å¥åº·å»ºè®®</h3>
                        <ul>
                            <li>ä¿æŒè§„å¾‹çš„ä½œæ¯æ—¶é—´ï¼Œç¡®ä¿å……è¶³çš„ç¡çœ ã€‚</li>
                            <li>é€‚å½“è¿›è¡Œä½“è‚²é”»ç‚¼ï¼Œå¦‚æ•£æ­¥ã€ç‘œä¼½ã€æ¸¸æ³³ç­‰ã€‚</li>
                            <li>åŸ¹å…»å…´è¶£çˆ±å¥½ï¼Œä¸°å¯Œç”Ÿæ´»å†…å®¹ã€‚</li>
                            <li>ä¿æŒè‰¯å¥½çš„äººé™…å…³ç³»ï¼Œå¤šä¸äº²å‹äº¤æµã€‚</li>
                            <li>å­¦ä¹ ç®€å•çš„æ”¾æ¾æŠ€å·§ï¼Œå¦‚æ·±å‘¼å¸ã€å†¥æƒ³ç­‰ã€‚</li>
                            ${overall.level !== 'å¿ƒç†å¥åº·' ? '<li>å»ºè®®å¯»æ±‚ä¸“ä¸šå¿ƒç†å’¨è¯¢å¸ˆæˆ–å¿ƒç†åŒ»ç”Ÿçš„å¸®åŠ©ã€‚</li>' : ''}
                        </ul>
                        <p style="margin-top: 15px; font-weight: bold; color: #991b1b;">
                            é‡è¦æç¤ºï¼šæœ¬æµ‹è¯•ç»“æœä»…ä¾›å‚è€ƒï¼Œä¸èƒ½æ›¿ä»£ä¸“ä¸šåŒ»ç”Ÿçš„è¯Šæ–­å’Œæ²»ç–—ã€‚å¦‚æœæ‚¨çš„ç—‡çŠ¶è¾ƒä¸ºä¸¥é‡ï¼Œå»ºè®®å°½å¿«å¯»æ±‚ä¸“ä¸šåŒ»ç–—å¸®åŠ©ã€‚
                        </p>
                    </div>

                    <div class="footer">
                        <p>Â© 2026 SCL-90å¿ƒç†å¥åº·è¯„ä¼°ç³»ç»Ÿ</p>
                    </div>
                </body>
                </html>
            `;
        }

        // åˆ†äº«æµ‹è¯•ç»“æœ
        function shareTestResult() {
            if (!testResult) return;

            try {
                const shareData = {
                    title: 'SCL-90å¿ƒç†å¥åº·æµ‹è¯•ç»“æœ',
                    text: `æˆ‘å®Œæˆäº†SCL-90å¿ƒç†å¥åº·æµ‹è¯•ï¼Œæ€»ä½“è¯„ä¼°ä¸º"${testResult.interpretation.overall.level}"ã€‚å¿«æ¥è¯•è¯•å§ï¼`,
                    url: window.location.href
                };

                if (navigator.share) {
                    navigator.share(shareData);
                } else {
                    // å¤åˆ¶åˆ°å‰ªè´´æ¿
                    navigator.clipboard.writeText(shareData.text + ' ' + shareData.url).then(() => {
                        showNotification('æˆåŠŸ', 'åˆ†äº«å†…å®¹å·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
                    });
                }
            } catch (error) {
                console.error('åˆ†äº«æµ‹è¯•ç»“æœæ—¶å‡ºé”™:', error);
                showNotification('é”™è¯¯', 'åˆ†äº«æµ‹è¯•ç»“æœå¤±è´¥', 'error');
            }
        }

        // åŠ è½½æµ‹è¯•å†å²
        function loadTestHistory() {
            const historyList = document.getElementById('history-list');
            const noHistory = document.getElementById('no-history');

            if (!historyList || !noHistory) return;

            try {
                const history = JSON.parse(localStorage.getItem('testHistory') || '[]');
                
                if (history.length === 0) {
                    historyList.classList.add('hidden');
                    noHistory.classList.remove('hidden');
                    return;
                }

                historyList.classList.remove('hidden');
                noHistory.classList.add('hidden');

                historyList.innerHTML = `
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        æµ‹è¯•æ—¶é—´
                                    </th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        æ€»åˆ†
                                    </th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        æ€»å‡åˆ†
                                    </th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        è¯„ä¼°ç»“æœ
                                    </th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        æ“ä½œ
                                    </th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                ${history.map(result => {
                                    const testDate = new Date(result.date).toLocaleString('zh-CN');
                                    const { overall } = result.interpretation;
                                    const { totalScore, meanScore } = result.scores;
                                    
                                    const levelColors = {
                                        'å¿ƒç†å¥åº·': 'bg-green-100 text-green-800',
                                        'è½»åº¦å¿ƒç†é—®é¢˜': 'bg-yellow-100 text-yellow-800',
                                        'ä¸­åº¦å¿ƒç†é—®é¢˜': 'bg-orange-100 text-orange-800',
                                        'é‡åº¦å¿ƒç†é—®é¢˜': 'bg-red-100 text-red-800'
                                    };

                                    return `
                                        <tr>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                                                ${testDate}
                                            </td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-medium">
                                                ${totalScore}
                                            </td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                ${meanScore.toFixed(2)}
                                            </td>
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${levelColors[overall.level] || 'bg-blue-100 text-blue-800'}">
                                                    ${overall.level}
                                                </span>
                                            </td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                                <button onclick="viewHistoryResult('${result.testId}')" class="text-blue-600 hover:text-blue-900 mr-3">
                                                    æŸ¥çœ‹
                                                </button>
                                                <button onclick="deleteHistoryResult('${result.testId}')" class="text-red-600 hover:text-red-900">
                                                    åˆ é™¤
                                                </button>
                                            </td>
                                        </tr>
                                    `;
                                }).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            } catch (error) {
                console.error('åŠ è½½æµ‹è¯•å†å²æ—¶å‡ºé”™:', error);
                historyList.classList.add('hidden');
                noHistory.classList.remove('hidden');
            }
        }

        // æŸ¥çœ‹å†å²ç»“æœ
        function viewHistoryResult(testId) {
            try {
                const history = JSON.parse(localStorage.getItem('testHistory') || '[]');
                const result = history.find(r => r.testId === testId);
                
                if (result) {
                    testResult = result;
                    displayTestResult();
                } else {
                    showNotification('é”™è¯¯', 'æœªæ‰¾åˆ°æµ‹è¯•ç»“æœ', 'error');
                }
            } catch (error) {
                console.error('æŸ¥çœ‹å†å²ç»“æœæ—¶å‡ºé”™:', error);
                showNotification('é”™è¯¯', 'æŸ¥çœ‹å†å²ç»“æœå¤±è´¥', 'error');
            }
        }

        // åˆ é™¤å†å²ç»“æœ
        function deleteHistoryResult(testId) {
            if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªæµ‹è¯•ç»“æœå—ï¼Ÿ')) return;

            try {
                let history = JSON.parse(localStorage.getItem('testHistory') || '[]');
                history = history.filter(r => r.testId !== testId);
                
                localStorage.setItem('testHistory', JSON.stringify(history));
                loadTestHistory();
                
                showNotification('æˆåŠŸ', 'æµ‹è¯•ç»“æœå·²åˆ é™¤', 'success');
            } catch (error) {
                console.error('åˆ é™¤å†å²ç»“æœæ—¶å‡ºé”™:', error);
                showNotification('é”™è¯¯', 'åˆ é™¤å†å²ç»“æœå¤±è´¥', 'error');
            }
        }

        // ç”Ÿæˆè¯¦ç»†AIåˆ†ææŠ¥å‘Š
        function generateDetailedAIReport() {
            if (!testResult) return;
            
            showNotification('ç”Ÿæˆä¸­', 'æ­£åœ¨ç”Ÿæˆè¯¦ç»†çš„AIåˆ†ææŠ¥å‘Š...', 'info');
            
            setTimeout(() => {
                const reportContent = `
                    ğŸ¤– **SCL-90 AIæ™ºèƒ½åˆ†ææŠ¥å‘Š**
                    
                    ğŸ“Š **æµ‹è¯•æ¦‚è§ˆ**
                    - æµ‹è¯•æ—¶é—´ï¼š${new Date(testResult.date).toLocaleString()}
                    - æ€»ä½“æ°´å¹³ï¼š${testResult.interpretation.overall.level}
                    - æ€»åˆ†ï¼š${testResult.interpretation.overall.totalScore}/450
                    
                    ğŸ¯ **æ ¸å¿ƒå‘ç°**
                    ${getTopFactor(testResult.interpretation.factors)}æ–¹é¢éœ€è¦é‡ç‚¹å…³æ³¨
                    
                    ğŸ’¡ **ä¸ªæ€§åŒ–å»ºè®®**
                    1. å»ºè®®æ¯å¤©è¿›è¡Œ15-30åˆ†é’Ÿçš„æ­£å¿µå†¥æƒ³ç»ƒä¹ 
                    2. å»ºç«‹è§„å¾‹çš„ç”Ÿæ´»ä½œæ¯è¡¨
                    3. æ¯å‘¨å®‰æ’3-5æ¬¡æœ‰æ°§è¿åŠ¨
                    4. å­¦ä¹ æƒ…ç»ªæ—¥è®°è®°å½•æ³•
                    5. å®šæœŸè¿›è¡Œç¤¾äº¤æ´»åŠ¨
                    
                    ğŸ“± **æ¨èèµ„æº**
                    - æ¨èå…³æ³¨å°çº¢ä¹¦-å°‘å¥³å°¤è¿¦è·å–æ›´å¤šå¿ƒç†å¥åº·çŸ¥è¯†
                    - å»ºè®®ä½¿ç”¨å†¥æƒ³ç±»APPè¾…åŠ©ç»ƒä¹ 
                    - å¯è€ƒè™‘å¯»æ±‚ä¸“ä¸šå¿ƒç†å’¨è¯¢å¸ˆçš„å¸®åŠ©
                    
                    âš ï¸ **å…è´£å£°æ˜**ï¼šæœ¬æŠ¥å‘Šç”±AIæ ¹æ®æµ‹è¯•æ•°æ®ç”Ÿæˆï¼Œä»…ä¾›å‚è€ƒï¼Œä¸æ„æˆåŒ»ç–—å»ºè®®ã€‚
                `;
                
                // åˆ›å»ºä¸€ä¸ªæ–°çª—å£æ˜¾ç¤ºæŠ¥å‘Š
                const reportWindow = window.open('', '_blank');
                reportWindow.document.write(`
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <title>SCL-90 AIæ™ºèƒ½åˆ†ææŠ¥å‘Š</title>
                        <style>
                            body { font-family: Arial, sans-serif; line-height: 1.6; padding: 20px; max-width: 800px; margin: 0 auto; }
                            h1 { color: #4F46E5; text-align: center; }
                            .report-content { background: #f8fafc; padding: 20px; border-radius: 8px; white-space: pre-wrap; }
                            .disclaimer { margin-top: 20px; padding: 10px; background: #fef2f2; border-left: 4px solid #ef4444; }
                        </style>
                    </head>
                    <body>
                        <h1>SCL-90 AIæ™ºèƒ½åˆ†ææŠ¥å‘Š</h1>
                        <div class="report-content">${reportContent}</div>
                        <div class="disclaimer">
                            <strong>å…è´£å£°æ˜ï¼š</strong>æœ¬æŠ¥å‘Šç”±AIæ ¹æ®æµ‹è¯•æ•°æ®è‡ªåŠ¨ç”Ÿæˆï¼Œä»…ä¾›å‚è€ƒï¼Œä¸æ„æˆåŒ»ç–—å»ºè®®ã€‚å¦‚ç—‡çŠ¶ä¸¥é‡ï¼Œè¯·åŠæ—¶å¯»æ±‚ä¸“ä¸šåŒ»ç–—å¸®åŠ©ã€‚
                        </div>
                    </body>
                    </html>
                `);
                
                showNotification('æˆåŠŸ', 'AIåˆ†ææŠ¥å‘Šå·²ç”Ÿæˆ', 'success');
            }, 2000);
        }
        
        // è·å–å¾—åˆ†æœ€é«˜çš„å› å­
        function getTopFactor(factors) {
            let topFactor = '';
            let maxScore = 0;
            
            Object.keys(factors).forEach(key => {
                const score = parseFloat(factors[key].score);
                if (score > maxScore) {
                    maxScore = score;
                    topFactor = factorDefinitions[key].name;
                }
            });
            
            return topFactor || 'å¿ƒç†å¥åº·';
        }
        
        // è·å–å¯èƒ½çš„åŸå› åˆ†æ
        function getPossibleReasons(highRiskFactors) {
            const reasons = {
                'somatization': 'èº«ä½“ä¸é€‚æˆ–å¥åº·é—®é¢˜',
                'obsessive': 'è¿‡åº¦è¿½æ±‚å®Œç¾æˆ–æ§åˆ¶æ¬²',
                'interpersonal': 'ç¤¾äº¤å‹åŠ›æˆ–äººé™…å…³ç³»å›°æ‰°',
                'depression': 'é•¿æœŸå‹åŠ›æˆ–è´Ÿé¢æƒ…ç»ªç§¯ç´¯',
                'anxiety': 'å·¥ä½œå‹åŠ›æˆ–ç”Ÿæ´»ä¸ç¡®å®šæ€§',
                'hostility': 'æƒ…ç»ªç®¡ç†å›°éš¾æˆ–äººé™…å†²çª',
                'phobic': 'ç‰¹å®šæƒ…å¢ƒçš„ææƒ§æˆ–å›é¿',
                'paranoid': 'ä¿¡ä»»æ„Ÿç¼ºå¤±æˆ–è¿‡åº¦è­¦æƒ•',
                'psychotic': 'æ€ç»´æ¨¡å¼æˆ–è®¤çŸ¥åå·®'
            };
            
            if (highRiskFactors.length > 0) {
                return highRiskFactors.map(factor => reasons[factor] || 'ç”Ÿæ´»å‹åŠ›').join('ã€');
            }
            
            return 'ç”Ÿæ´»å‹åŠ›æˆ–æƒ…ç»ªç®¡ç†';
        }
        
        // è·å–ä¸“å®¶å»ºè®®
        function getExpertAdvice(overallLevel, highRiskFactors) {
            const adviceMap = {
                'å¿ƒç†å¥åº·': 'æ‚¨çš„å¿ƒç†çŠ¶æ€æ•´ä½“è‰¯å¥½ï¼Œå»ºè®®ç»§ç»­ä¿æŒç°æœ‰çš„ç”Ÿæ´»æ–¹å¼å’Œå¿ƒæ€ï¼Œå®šæœŸè¿›è¡Œè‡ªæˆ‘è¯„ä¼°å’Œå¿ƒç†å¥åº·ç»´æŠ¤ã€‚',
                'è½»åº¦å¿ƒç†é—®é¢˜': 'æ‚¨ç›®å‰å­˜åœ¨è½»åº¦çš„å¿ƒç†é—®é¢˜ï¼Œå»ºè®®ä»è°ƒæ•´ç”Ÿæ´»æ–¹å¼å…¥æ‰‹ï¼Œå¦‚æ”¹å–„ç¡çœ è´¨é‡ã€å¢åŠ ä½“è‚²é”»ç‚¼ã€åŸ¹å…»å…´è¶£çˆ±å¥½ç­‰ã€‚å¦‚ç—‡çŠ¶æŒç»­ï¼Œå¯è€ƒè™‘å¯»æ±‚å¿ƒç†å’¨è¯¢å¸ˆçš„å¸®åŠ©ã€‚',
                'ä¸­åº¦å¿ƒç†é—®é¢˜': 'æ‚¨çš„å¿ƒç†é—®é¢˜å·²è¾¾åˆ°ä¸­åº¦æ°´å¹³ï¼Œå¼ºçƒˆå»ºè®®å¯»æ±‚ä¸“ä¸šå¿ƒç†å’¨è¯¢å¸ˆçš„å¸®åŠ©ã€‚åŒæ—¶ï¼Œå»ºè®®æ‚¨å…³æ³¨æƒ…ç»ªç®¡ç†ï¼Œå­¦ä¹ å‹åŠ›åº”å¯¹æŠ€å·§ï¼Œå¿…è¦æ—¶å¯è€ƒè™‘å¿ƒç†æ²»ç–—ã€‚',
                'é‡åº¦å¿ƒç†é—®é¢˜': 'æ‚¨çš„å¿ƒç†é—®é¢˜è¾ƒä¸ºä¸¥é‡ï¼Œå¿…é¡»å°½å¿«å¯»æ±‚ä¸“ä¸šå¿ƒç†åŒ»ç”Ÿæˆ–ç²¾ç¥ç§‘åŒ»ç”Ÿçš„å¸®åŠ©ã€‚è¯·ä¸è¦ç‹¬è‡ªæ‰¿å—ï¼ŒåŠæ—¶å¯»æ±‚ä¸“ä¸šæ”¯æŒæ˜¯æœ€é‡è¦çš„ã€‚'
            };
            
            let advice = adviceMap[overallLevel] || adviceMap['å¿ƒç†å¥åº·'];
            
            // æ ¹æ®é«˜é£é™©å› å­æ·»åŠ ç‰¹å®šå»ºè®®
            if (highRiskFactors.includes('depression')) {
                advice += ' ç‰¹åˆ«æé†’ï¼šæ‚¨åœ¨æŠ‘éƒæ–¹é¢çš„å¾—åˆ†è¾ƒé«˜ï¼Œå»ºè®®å¤šå‚åŠ é˜³å…‰æ´»åŠ¨ï¼Œä¿æŒç¤¾äº¤äº’åŠ¨ï¼Œå¿…è¦æ—¶å¯»æ±‚ä¸“ä¸šçš„æŠ‘éƒæ²»ç–—ã€‚';
            }
            
            if (highRiskFactors.includes('anxiety')) {
                advice += ' ç‰¹åˆ«æé†’ï¼šæ‚¨åœ¨ç„¦è™‘æ–¹é¢çš„å¾—åˆ†è¾ƒé«˜ï¼Œå»ºè®®å­¦ä¹ æ­£å¿µå†¥æƒ³ç­‰æ”¾æ¾æŠ€å·§ï¼Œé¿å…è¿‡åº¦æ‹…å¿§ï¼Œå¿…è¦æ—¶å¯è€ƒè™‘ä¸“ä¸šçš„ç„¦è™‘ç®¡ç†è®­ç»ƒã€‚';
            }
            
            return advice;
        }

        // æ˜¾ç¤ºé€šçŸ¥
        function showNotification(title, message, type = 'success') {
            const notification = document.getElementById('notification');
            const titleEl = document.getElementById('notificationTitle');
            const messageEl = document.getElementById('notificationMessage');
            const iconEl = document.getElementById('notificationIcon');
            
            titleEl.textContent = title;
            messageEl.textContent = message;
            
            // è®¾ç½®å›¾æ ‡å’Œé¢œè‰²
            if (type === 'success') {
                iconEl.innerHTML = '<i class="fa fa-check-circle text-green-500 text-xl"></i>';
            } else if (type === 'error') {
                iconEl.innerHTML = '<i class="fa fa-times-circle text-red-500 text-xl"></i>';
            } else if (type === 'warning') {
                iconEl.innerHTML = '<i class="fa fa-exclamation-triangle text-yellow-500 text-xl"></i>';
            } else if (type === 'info') {
                iconEl.innerHTML = '<i class="fa fa-info-circle text-blue-500 text-xl"></i>';
            }
            
            notification.classList.remove('translate-x-full');
            
            // 3ç§’åè‡ªåŠ¨å…³é—­
            setTimeout(() => {
                notification.classList.add('translate-x-full');
            }, 3000);
        }
    </script>
</body>
</html>